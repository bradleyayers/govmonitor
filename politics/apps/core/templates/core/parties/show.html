{% extends "core/parties/base.html" %}

{% load core %}

{% block html-class %}
    {{ block.super }}
    party
{% endblock %}

{% block title %}{{ block.super }} / {{ party.name }}{% endblock %}

{% block header-secondary %}
    <div id="header-secondary">
        <div class="right">
            <a class="button" href="{% url core:parties:new-child party.pk %}">New Party</a>
        </div>
    </div>
{% endblock %}

{% block content %}
    {{ block.super }}
    <div id="content-primary">
        <h1><a href="{% url core:parties:list %}">Parties</a> / <strong>{{ party.name }}</strong></h1>

        <a class="icon-pencil" href="{% url core:parties:edit party.pk %}">Edit</a>

        {% if children %}
            <h2 class="section">Branches</h2>
            <ol class="parties">
                {% for child in children %}
                    <li>
                        <a href="{% url core:parties:show child.pk child.slug %}">{{ child.name }}</a>
                        <span>{{ party.view_percentage|floatformat:0 }}% of issues available</span>
                    </li>
                {% endfor %}
            </ol>
        {% endif %}

        <ol class="tabs">
            <li {% if request.GET.issues != "unknown" %}class="selected"{% endif %}><a href="{% query_string issues="known" %}" id="tab-known">Known</a></li>
            <li {% if request.GET.issues == "unknown" %}class="selected"{% endif %}><a href="{% query_string issues="unknown" %}" id="tab-unknown">Unknown</a></li>
        </ol>

        {% for view_row in view_rows %}
            <div class="view-summary-row">
                {% for view in view_row %}
                    {% with heading=view.issue.name %}
                        {% include "core/views/_summary.html" %}
                    {% endwith %}
                {% endfor %}
            </div>
        {% endfor %}
    </div>

    <div id="content-secondary">
        {% if party_similarities %}
            <h2 class="section">Similar Parties <a class="help" href="{% url core:about %}#question-party-similarity">?</a></h2>
            <ol class="similar-parties">
                {% for party_similarity in party_similarities|slice:":3" %}
                    {% with other_party=party_similarity.second_party %}
                        <li>
                            <span>{{ party_similarity.percentage_similarity|floatformat:0 }}%</span>
                            <a href="{% url core:parties:show other_party.pk other_party.slug %}">{{ other_party.name }}</a>
                        </li>
                    {% endwith %}
                {% endfor %}
            </ol>
        {% endif %}
    </div>
{% endblock %}
