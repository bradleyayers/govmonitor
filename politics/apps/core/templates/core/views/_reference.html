{% load comments core %}

<div class="commentable" data-comment-url="{% url core:references:comments reference.pk %}">
    <div class="reference {{ reference.stance }}">
        <div class="content">
            <h2><a href="{{ reference.url }}">{{ reference.title }}</a></h2>
            <span class="pill {{ reference.stance }}">{{ reference.get_stance_display }}</span>

            {% if reference.published_on %}
                <span class="icon-time published" title="{{ reference.published_on }}">Published <strong>{{ reference.published_on|interval_string }}</strong> ago</span>
            {% endif %}

            <div class="markdown">
                {% if reference.text_html %}
                    {{ reference.text_html|safe }}
                {% else %}
                    <i>No description available, see source.</i>
                {% endif %}
            </div>
        </div>
        <footer>
            <ol class="actions">
                <li><a class="add-comment icon-comment" href="#">Comment</a></li>
                <li><a class="icon-pencil" href="{% url core:references:edit reference.pk %}">Edit</a></li>
            </ol>
        </footer>
    </div>

    {% comments reference %}
</div>
