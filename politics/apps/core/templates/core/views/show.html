{% extends "core/base.html" %}

{% load core votes %}

{% block html-class %}
    {{ block.super }}
    view
{% endblock %}

{% block title %}{{ view.issue.name }} â€“ {{ view.party.name }}{% endblock %}

{% block javascript %}
    {{ block.super }}
    {% vote_data current_reference references %}
{% endblock %}

{% block content %}
    {{ block.super }}
    <div id="content-primary">
        <h1>
            <a href="{% url core:parties:show view.party.pk view.party.slug %}">{{ view.party.name }}</a> /
            <strong><a href="{% url core:issues:show view.issue.pk view.issue.slug %}">{{ view.issue.name }}</a></strong>
        </h1>

        <div class="references">
            {% if current_reference %}
                <h2 class="section">Current Reference</h2>
                {% with reference=current_reference %}
                    {% include "core/views/_reference.html" %}
                {% endwith %}
            {% endif %}
            {% if references %}
                <h2 class="section">References</h2>
                {% for reference in references %}
                    {% include "core/views/_reference.html" %}
                {% endfor %}
            {% else %}
                <i>There aren't any references. Why not submit one?</i>
            {% endif %}
        </div>

        {% if request.user.is_authenticated %}
            <h2 class="section">Add a Reference</h2>
            <form class="reference" method="post">
                {% include "core/references/_form.html" %}
                <p><input class="button" type="submit" value="Add"/></p>
            </form>
        {% endif %}
    </div>
{% endblock %}
